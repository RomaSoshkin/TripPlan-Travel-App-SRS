# 5. Варианты использования (Use Cases)

## UC-1: Вход без авторизации

**Краткое описание:** Неавторизованный пользователь знакомится с возможностями приложения через ограниченный функционал.

**Действующие лица:** Неавторизованный пользователь.

**Триггер:** Пользователь открыл приложение впервые.

**Предусловия:** Приложение успешно запущено.

**Постусловие:** Пользователь получил представление о функционале приложения.

**Результат:** Пользователь готов зарегистрироваться или авторизоваться.

### ПОТОКИ

**Основной поток:**
1. Система отображает экран авторизации с кнопкой "Продолжить без авторизации".
2. Пользователь выбирает "Продолжить без авторизации".
3. Система загружает ограниченные данные.
4. Система отображает ограниченный функционал.
5. Пользователь изучает интерфейс.
6. Вариант использования завершает свою работу.

**Альтернативный поток:**
1. Пользователь выбирает "Войти/Зарегистрироваться".
2. Управление передается UC-2_1 или UC-2_2.
3. Вариант использования завершает свою работу.

---

## UC-2_1: Регистрация по email

**Краткое описание:** Пользователь создает учетную запись с помощью email и пароля.

**Действующие лица:** Неавторизованный пользователь.

**Триггер:** Пользователь выбрал "Регистрация аккаунта".

**Предусловия:** Приложение подключено к интернету.

**Постусловие:** В системе создана новая учетная запись.

**Результат:** Пользователь авторизован в системе.

### ПОТОКИ

**Основной поток:**
1. Система отображает форму регистрации (email, пароль, подтверждение пароля).
2. Пользователь вводит email и пароль (6+ символов, латинские буквы обоих регистров + минимум 1 цифра).
3. Система проверяет формат данных.
4. Система проверяет уникальность email.
5. Система создает учетную запись.
6. Система выполняет автоматический вход.
7. Система отображает главный экран приложения.
8. Вариант использования завершает свою работу.

**Поток исключения:**
- **Email уже зарегистрирован:**
    1. Система отображает ошибку "Этот email уже используется".
    2. Управление возвращается к шагу 2 основного потока.

---

## UC-2_2: Вход через соцсети

**Краткое описание:** Пользователь авторизуется через интеграцию с социальными сетями (VK ID, Яндекс, Telegram).

**Действующие лица:** Неавторизованный пользователь, API VK ID, API Яндекс ID, API Telegram.

**Триггер:** Пользователь выбрал "Войти через [соцсеть]".

**Предусловия:** Приложение подключено к интернету.

**Постусловие:** Пользователь успешно авторизован.

**Результат:** Доступ к полному функционалу приложения.

### ПОТОКИ

**Основной поток:**
1. Система отображает варианты входа через соцсети.
2. Пользователь выбирает соцсеть (VK/Яндекс/Telegram).
3. Система перенаправляет в выбранную соцсеть.
4. Пользователь подтверждает права доступа.
5. Соцсеть возвращает авторизационные данные.
6. Система проверяет данные и создает/обновляет учетную запись.
7. Система выполняет вход.
8. Вариант использования завершает свою работу.

**Поток исключения:**
- **Ошибка авторизации:**
    1. Система отображает "Не удалось войти через [соцсеть]".
    2. Управление возвращается к шагу 2 основного потока.

---

## UC-2_3: Восстановление пароля

**Краткое описание:** Пользователь восстанавливает доступ к учетной записи через email.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Забыли пароль?".

**Предусловия:** Учетная запись зарегистрирована по email.

**Постусловие:** На email отправлена ссылка для сброса пароля.

**Результат:** Пользователь может установить новый пароль.

### ПОТОКИ

**Основной поток:**
1. Система отображает поле для ввода email.
2. Пользователь вводит email.
3. Система проверяет существование учетной записи.
4. Система генерирует и отправляет ссылку для сброса.
5. Система отображает уведомление "Письмо отправлено".
6. Вариант использования завершает свою работу.

**Поток исключения:**
- **Email не зарегистрирован:**
    1. Система отображает "Учетная запись не найдена".
    2. Управление возвращается к шагу 2 основного потока.

---

## UC-3_1: Создание путешествия

**Краткое описание:** Авторизованный пользователь создает новое путешествие.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Добавить путешествие".

**Предусловия:** Пользователь авторизован.

**Постусловие:** В системе создана запись о новом путешествии.

**Результат:** Пользователь может добавлять города и точки интереса.

### ПОТОКИ

**Основной поток:**
1. Система отображает форму создания путешествия.
2. Пользователь вводит:
    - Страну путешествия.
    - Город.
    - Даты начала/окончания.
3. Пользователь нажимает "Сохранить".
4. Система проверяет корректность дат.
5. Система создает запись о путешествии.
6. Система отображает экран редактирования путешествия.
7. Вариант использования завершает свою работу.

**Поток исключения:**
- **Даты указаны некорректно:**
    1. Система отображает ошибку "Дата окончания не может быть раньше даты начала".
    2. Управление возвращается к шагу 2 основного потока.

---

## UC-3_2: Добавление городов

**Краткое описание:** Пользователь добавляет города в существующее путешествие.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Добавить город".

**Предусловия:** В системе существует хотя бы одно путешествие.

**Постусловие:** Город добавлен в путешествие.

**Результат:** Маршрут путешествия расширен.

### ПОТОКИ

**Основной поток:**
1. Система отображает список путешествий.
2. Пользователь выбирает путешествие.
3. Система отображает текущий маршрут.
4. Пользователь выбирает "Добавить город".
5. Система отображает форму добавления.
6. Пользователь вводит название города.
7. Система проверяет уникальность города в маршруте.
8. Система сохраняет изменения.
9. Вариант использования завершает свою работу.

**Поток исключения:**
- **Город уже есть в маршруте:**
    1. Система отображает "Этот город уже добавлен".
    2. Управление возвращается к шагу 6 основного потока.
- **Достигнут лимит (10 городов):**
    1. Система отображает "Максимум 10 городов на поездку".
    2. Вариант использования завершает свою работу.

---

## UC-3_3: Управление точками интереса

**Краткое описание:** Пользователь добавляет/редактирует точки интереса в городах маршрута.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Добавить точку".

**Предусловия:** В маршруте есть хотя бы один город.

**Постусловие:** Точка интереса сохранена в системе.

**Результат:** Маршрут дополнен новыми местами посещения.

### ПОТОКИ

**Основной поток:**
1. Система отображает список городов путешествия.
2. Пользователь выбирает город.
3. Система отображает список точек интереса.
4. Пользователь выбирает "Добавить точку".
5. Система отображает форму добавления.
6. Пользователь вводит:
    - Название места.
    - Адрес (опционально).
    - Заметки.
    - Дату посещения.
7. Пользователь сохраняет данные.
8. Система проверяет корректность даты.
9. Система сохраняет точку интереса.
10. Вариант использования завершает свою работу.

---

## UC-4_1: Добавление расходов

**Краткое описание:** Пользователь фиксирует расходы, связанные с путешествием.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Бюджет".

**Предусловия:** В системе существует хотя бы одно путешествие.

**Постусловие:** В системе создана запись о новом расходе.

**Результат:** Общий бюджет путешествия обновлен.

### ПОТОКИ

**Основной поток:**
1. Система отображает список активных путешествий.
2. Пользователь выбирает путешествие.
3. Пользователь нажимает кнопку добавления расходов.
4. Система отображает форму добавления расхода.
5. Пользователь вводит:
    - Сумму (только цифры).
    - Выбирает категорию из списка (5 предустановленных или пользовательских).
    - Описание (опционально).
6. Пользователь нажимает "Сохранить".
7. Система проверяет корректность данных.
8. Система сохраняет расход.
9. Система обновляет статистику по путешествию.
10. Вариант использования завершает свою работу.

---

## UC-4_2: Управление категориями

**Краткое описание:** Пользователь создает/редактирует категории для учета расходов.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Управление категориями".

**Предусловия:** Пользователь авторизован.

**Постусловие:** Список категорий обновлен.

**Результат:** Новые категории доступны для учета расходов.

### ПОТОКИ

**Основной поток:**
1. Система отображает список предустановленных категорий (транспорт, жилье и т.д.).
2. Пользователь выбирает "Добавить категорию".
3. Система отображает форму создания.
4. Пользователь вводит название новой категории.
5. Система проверяет уникальность названия.
6. Система сохраняет категорию.
7. Вариант использования завершает свою работу.

**Поток исключения:**
- **Категория уже существует:**
    1. Система отображает "Такая категория уже есть".
    2. Управление возвращается к шагу 4 основного потока.
- **Достигнут лимит (20 пользовательских категорий):**
    1. Система отображает "Максимум 20 пользовательских категорий".
    2. Вариант использования завершает свою работу.

---

## UC-4_3: Просмотр финансовых отчетов

**Краткое описание:** Пользователь анализирует расходы через визуализированные отчеты.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Показать график".

**Предусловия:** В системе есть данные о расходах.

**Постусловие:** Пользователь получил наглядное представление о расходах.

**Результат:** Возможность анализа структуры затрат.

### ПОТОКИ

**Основной поток:**
1. Система отображает список путешествий.
2. Пользователь выбирает путешествие.
3. Пользователь выбирает бюджет.
4. Пользователь нажимает на кнопку "Показать график".
5. Система загружает данные о расходах.
6. Система отображает:
    - Общую сумму расходов.
    - Круговую диаграмму по категориям.
    - Столбчатую диаграмму по датам.
7. Пользователь изучает отчеты.
8. Вариант использования завершает свою работу.

---

## UC-5_1: Загрузка документов

**Краткое описание:** Пользователь загружает документы, связанные с путешествием.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Документы".

**Предусловия:** В системе существует хотя бы одно путешествие.

**Постусловие:** Документ сохранен в системе и привязан к путешествию.

**Результат:** Пользователь может просматривать документ в любое время.

### ПОТОКИ

**Основной поток:**
1. Система отображает список активных путешествий.
2. Пользователь выбирает путешествие.
3. Пользователь нажимает кнопку добавления документов.
4. Система отображает интерфейс загрузки документов.
5. Пользователь выбирает файл (PDF, JPG, PNG, JPEG, до 5 МБ).
6. Система проверяет формат и размер файла.
7. Система сохраняет документ.
8. Система отображает уведомление об успешной загрузке.
9. Вариант использования завершает свою работу.

**Поток исключения:**
- **Файл не соответствует требованиям:**
    1. Система отображает ошибку "Недопустимый формат или размер файла".
    2. Управление возвращается к шагу 4 основного потока.

---

## UC-5_2: Просмотр документов

**Краткое описание:** Пользователь просматривает загруженные документы.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пользователь выбрал "Документы".

**Предусловия:** В системе есть загруженные документы.

**Постусловие:** Пользователь получил доступ к документам.

**Результат:** Возможность просмотра и поиска документов.

### ПОТОКИ

**Основной поток:**
1. Система отображает список путешествий.
2. Пользователь выбирает путешествие.
3. Пользователь выбирает документы.
4. Система загружает список документов.
5. Пользователь выбирает документ.
6. Система отображает содержимое (PDF/изображение).
7. Вариант использования завершает свою работу.

---

## UC-6: Работа в оффлайн-режиме

**Краткое описание:** Пользователь работает с приложением без интернет-соединения.

**Действующие лица:** Авторизованный пользователь.

**Триггер:** Пропало интернет-соединение.

**Предусловия:** Пользователь ранее авторизовался.

**Постусловие:** Данные синхронизированы при восстановлении соединения.

**Результат:** Пользователь может работать с локальными данными.

### ПОТОКИ

**Основной поток:**
1. Система определяет отсутствие соединения.
2. Система переключается в оффлайн-режим.
3. Пользователь работает с кэшированными данными.
4. Система сохраняет изменения локально.
5. При восстановлении соединения система синхронизирует данные.
6. Вариант использования завершает свою работу.

---

## UC-7: Получение рекомендаций

**Краткое описание:** Система предлагает персонализированные рекомендации на основе API отелей/авиабилетов.

**Действующие лица:** Авторизованный пользователь, API отелей, API авиабилетов.

**Триггер:** Пользователь открыл раздел "Рекомендации".

**Предусловия:** В системе есть активные путешествия.

**Постусловие:** Пользователь получил персонализированные предложения.

**Результат:** Возможность расширения планов путешествия.

### ПОТОКИ

**Основной поток:**
1. Система определяет текущие планы пользователя.
2. Система отправляет запросы к API отелей и авиабилетов.
3. API возвращают актуальные предложения.
4. Система фильтрует предложения по релевантности.
5. Система отображает рекомендации с ценами.
6. Вариант использования завершает свою работу.

---

## UC-8: Управление рекламными материалами

**Краткое описание:** Партнер размещает/редактирует рекламные материалы.

**Действующие лица:** Партнер (турагентство).

**Триггер:** Партнер выбрал "Управление рекламой".

**Предусловия:** Партнер авторизован с соответствующими правами.

**Постусловие:** Рекламные материалы обновлены.

**Результат:** Новые рекламные блоки видны пользователям.

### ПОТОКИ

**Основной поток:**
1. Система отображает интерфейс управления рекламой.
2. Партнер загружает новые материалы (изображения/текст).
3. Система проверяет формат и размер.
4. Система сохраняет материалы.
5. Вариант использования завершает свою работу.

---

## UC-9: Просмотр аналитики пользователей

**Краткое описание:** Партнер анализирует поведение пользователей.

**Действующие лица:** Партнер (турагентство).

**Триггер:** Партнер открыл раздел "Аналитика".

**Предусловия:** Партнер авторизован с соответствующими правами.

**Постусловие:** Партнер получил статистические данные.

**Результат:** Возможность оптимизации рекламных кампаний.

### ПОТОКИ

**Основной поток:**
1. Система собирает агрегированные данные о:
    - Популярных направлениях.
    - Среднем бюджете поездок.
    - Конверсии рекламных предложений.
2. Система визуализирует данные в виде графиков.
3. Партнер изучает отчеты.
4. Вариант использования завершает свою работу.
